#!/bin/bash
# Include wired net drivers, excluding wireless

net_module_test() {
    local net_drivers='eth_type_trans|register_virtio_device'
    local unwanted_drivers='/(wireless|isdn|uwb)/'
    nm -uPA "$1" | egrep -q $net_drivers && \
	nm -uPA "$1" | egrep -qv 'iw_handler_get_spy' && \
	[[ ! $1 =~ $unwanted_drivers ]]
}

instmods $(filter_kernel_modules net_module_test)
    
instmods ecb arc4
# bridge modules
instmods bridge stp llc
